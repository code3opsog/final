{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/stashy/Desktop/Projects/Trend/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseKey);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,gMAAY,EAAC,aAAa"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/stashy/Desktop/Projects/Trend/src/app/api/admin/analytics/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { cookies } from 'next/headers';\r\n\r\nexport async function GET() {\r\n    try {\r\n        const cookieStore = await cookies();\r\n        const sessionToken = cookieStore.get('session_token')?.value;\r\n\r\n        if (!sessionToken) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Verify admin\r\n        const { data: session } = await supabase\r\n            .from('sessions')\r\n            .select('user_id')\r\n            .eq('token', sessionToken)\r\n            .single();\r\n\r\n        if (!session) {\r\n            return NextResponse.json({ error: 'Invalid session' }, { status: 401 });\r\n        }\r\n\r\n        const { data: user } = await supabase\r\n            .from('users')\r\n            .select('is_admin')\r\n            .eq('id', session.user_id)\r\n            .single();\r\n\r\n        if (!user?.is_admin) {\r\n            return NextResponse.json({ error: 'Admin access required' }, { status: 403 });\r\n        }\r\n\r\n        // Gather analytics data\r\n        const [usersResult, accountsResult, sessionsResult, logsResult] = await Promise.all([\r\n            supabase.from('users').select('id', { count: 'exact', head: true }),\r\n            supabase.from('roblox_accounts').select('id', { count: 'exact', head: true }),\r\n            supabase.from('sessions').select('id', { count: 'exact', head: true }),\r\n            supabase.from('filter_logs').select('id', { count: 'exact', head: true })\r\n        ]);\r\n\r\n        // Get recent activity (last 7 days)\r\n        const sevenDaysAgo = new Date();\r\n        sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\r\n\r\n        const { data: recentLogs } = await supabase\r\n            .from('filter_logs')\r\n            .select('action, created_at')\r\n            .gte('created_at', sevenDaysAgo.toISOString())\r\n            .order('created_at', { ascending: false });\r\n\r\n        // Count actions by type\r\n        const actionCounts = {\r\n            accepted: 0,\r\n            declined: 0,\r\n            blocked: 0\r\n        };\r\n\r\n        recentLogs?.forEach(log => {\r\n            if (log.action === 'accepted') actionCounts.accepted++;\r\n            else if (log.action === 'declined') actionCounts.declined++;\r\n            else if (log.action === 'blocked') actionCounts.blocked++;\r\n        });\r\n\r\n        return NextResponse.json({\r\n            stats: {\r\n                totalUsers: usersResult.count || 0,\r\n                totalAccounts: accountsResult.count || 0,\r\n                activeSessions: sessionsResult.count || 0,\r\n                totalLogs: logsResult.count || 0\r\n            },\r\n            recentActivity: actionCounts,\r\n            recentLogsCount: recentLogs?.length || 0\r\n        });\r\n    } catch (error) {\r\n        console.error('Analytics error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch analytics' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe;IAClB,IAAI;QACA,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,eAAe,YAAY,GAAG,CAAC,kBAAkB;QAEvD,IAAI,CAAC,cAAc;YACf,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,eAAe;QACf,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,WACP,EAAE,CAAC,SAAS,cACZ,MAAM;QAEX,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,MAAM,EAAE,MAAM,IAAI,EAAE,GAAG,MAAM,oIAAQ,CAChC,IAAI,CAAC,SACL,MAAM,CAAC,YACP,EAAE,CAAC,MAAM,QAAQ,OAAO,EACxB,MAAM;QAEX,IAAI,CAAC,MAAM,UAAU;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,wBAAwB;QACxB,MAAM,CAAC,aAAa,gBAAgB,gBAAgB,WAAW,GAAG,MAAM,QAAQ,GAAG,CAAC;YAChF,oIAAQ,CAAC,IAAI,CAAC,SAAS,MAAM,CAAC,MAAM;gBAAE,OAAO;gBAAS,MAAM;YAAK;YACjE,oIAAQ,CAAC,IAAI,CAAC,mBAAmB,MAAM,CAAC,MAAM;gBAAE,OAAO;gBAAS,MAAM;YAAK;YAC3E,oIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,MAAM;gBAAE,OAAO;gBAAS,MAAM;YAAK;YACpE,oIAAQ,CAAC,IAAI,CAAC,eAAe,MAAM,CAAC,MAAM;gBAAE,OAAO;gBAAS,MAAM;YAAK;SAC1E;QAED,oCAAoC;QACpC,MAAM,eAAe,IAAI;QACzB,aAAa,OAAO,CAAC,aAAa,OAAO,KAAK;QAE9C,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,oIAAQ,CACtC,IAAI,CAAC,eACL,MAAM,CAAC,sBACP,GAAG,CAAC,cAAc,aAAa,WAAW,IAC1C,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE5C,wBAAwB;QACxB,MAAM,eAAe;YACjB,UAAU;YACV,UAAU;YACV,SAAS;QACb;QAEA,YAAY,QAAQ,CAAA;YAChB,IAAI,IAAI,MAAM,KAAK,YAAY,aAAa,QAAQ;iBAC/C,IAAI,IAAI,MAAM,KAAK,YAAY,aAAa,QAAQ;iBACpD,IAAI,IAAI,MAAM,KAAK,WAAW,aAAa,OAAO;QAC3D;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,OAAO;gBACH,YAAY,YAAY,KAAK,IAAI;gBACjC,eAAe,eAAe,KAAK,IAAI;gBACvC,gBAAgB,eAAe,KAAK,IAAI;gBACxC,WAAW,WAAW,KAAK,IAAI;YACnC;YACA,gBAAgB;YAChB,iBAAiB,YAAY,UAAU;QAC3C;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ"}}]
}